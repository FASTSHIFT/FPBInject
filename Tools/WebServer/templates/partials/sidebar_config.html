<!-- Configuration Section -->
<div class="sidebar-section" data-section-id="configuration">
  <details id="details-configuration">
    <summary class="sidebar-header">
      <i class="codicon codicon-chevron-right"></i>
      <span>CONFIGURATION</span>
    </summary>
    <div class="sidebar-content">
      <div class="flex-col">
        <div class="flex-row">
          <label
            for="elfPath"
            style="font-size: 11px; width: 80px"
            title="Path to the compiled ELF file for symbol lookup and disassembly"
            >ELF Path</label
          >
          <input type="text" id="elfPath" class="vscode-input" style="flex: 1" placeholder="/path/to/firmware.elf" />
          <button class="vscode-btn icon-only secondary" onclick="browseFile('elfPath', '.elf')">
            <i class="codicon codicon-folder-opened"></i>
          </button>
        </div>
        <div class="flex-row">
          <label
            for="compileCommandsPath"
            style="font-size: 11px; width: 80px"
            title="Path to compile_commands.json for accurate compile flags (include paths, defines, etc.)"
            >Compile DB</label
          >
          <input
            type="text"
            id="compileCommandsPath"
            class="vscode-input"
            style="flex: 1"
            placeholder="/path/to/compile_commands.json"
          />
          <button class="vscode-btn icon-only secondary" onclick="browseFile('compileCommandsPath', '.json')">
            <i class="codicon codicon-folder-opened"></i>
          </button>
        </div>
        <div class="flex-row">
          <label
            for="toolchainPath"
            style="font-size: 11px; width: 80px"
            title="Path to cross-compiler toolchain bin directory (e.g., arm-none-eabi-gcc)"
            >Toolchain</label
          >
          <input
            type="text"
            id="toolchainPath"
            class="vscode-input"
            style="flex: 1"
            placeholder="/path/to/toolchain/bin"
          />
          <button class="vscode-btn icon-only secondary" onclick="browseDir('toolchainPath')">
            <i class="codicon codicon-folder-opened"></i>
          </button>
        </div>
        <div class="flex-row">
          <label
            for="patchMode"
            style="font-size: 11px; width: 80px"
            title="Trampoline: Use code trampoline (default)&#10;DebugMonitor: Use DebugMonitor exception&#10;Direct: Direct code replacement"
            >Inject Mode</label
          >
          <select id="patchMode" class="vscode-select" style="flex: 1">
            <option value="trampoline">Trampoline</option>
            <option value="debugmon">DebugMonitor</option>
            <option value="direct">Direct</option>
          </select>
        </div>
        <div class="flex-row">
          <label
            for="chunkSize"
            style="font-size: 11px; width: 80px"
            title="The size of each uploaded data block (in bytes). Smaller values are more stable but slower."
            >Chunk Size</label
          >
          <input
            type="number"
            id="chunkSize"
            class="vscode-input"
            value="128"
            min="16"
            max="1024"
            step="16"
            style="width: 60px"
          />
          <span style="font-size: 10px; opacity: 0.6; margin-left: 4px">Bytes</span>
        </div>
        <div class="flex-row">
          <label
            for="txChunkSize"
            style="font-size: 11px; width: 80px"
            title="TX chunk size for serial commands (bytes). 0 = disabled. Workaround for slow serial drivers that may drop data on large transfers. Enable if you experience command failures or data corruption."
            >TX Chunk</label
          >
          <input
            type="number"
            id="txChunkSize"
            class="vscode-input"
            value="0"
            min="0"
            max="256"
            step="8"
            style="width: 60px"
          />
          <span style="font-size: 10px; opacity: 0.6; margin-left: 4px">Bytes</span>
        </div>
        <div class="flex-row">
          <label
            for="txChunkDelay"
            style="font-size: 11px; width: 80px"
            title="Delay between TX chunks (milliseconds). Workaround for slow serial drivers. Only used when TX Chunk > 0."
            >TX Delay</label
          >
          <input
            type="number"
            id="txChunkDelay"
            class="vscode-input"
            value="5"
            min="1"
            max="100"
            step="1"
            style="width: 60px"
          />
          <span style="font-size: 10px; opacity: 0.6; margin-left: 4px">ms</span>
        </div>
        <div class="flex-row">
          <label
            for="transferMaxRetries"
            style="font-size: 11px; width: 80px"
            title="Maximum retry attempts for file transfer when CRC mismatch or transmission error occurs."
            >Max Retries</label
          >
          <input
            type="number"
            id="transferMaxRetries"
            class="vscode-input"
            value="3"
            min="0"
            max="10"
            step="1"
            style="width: 60px"
          />
          <span style="font-size: 10px; opacity: 0.6; margin-left: 4px">times</span>
        </div>
        <div class="flex-row">
          <label for="logFilePath" style="font-size: 11px; width: 80px" title="Path to save serial logs"
            >Log Path</label
          >
          <input
            type="text"
            id="logFilePath"
            class="vscode-input"
            style="flex: 1"
            placeholder="~/fpb_console.log"
            onchange="onLogFilePathChange()"
          />
          <button class="vscode-btn icon-only secondary" onclick="browseLogFile()" id="browseLogFileBtn">
            <i class="codicon codicon-folder-opened"></i>
          </button>
        </div>
        <div class="flex-row" title="Record serial communication logs to file">
          <input type="checkbox" id="logFileEnabled" onchange="onLogFileEnabledChange()" />
          <label for="logFileEnabled" style="font-size: 11px">Record Serial Logs</label>
        </div>
        <div class="flex-row">
          <input type="checkbox" id="autoCompile" onchange="onAutoCompileChange()" />
          <label for="autoCompile" style="font-size: 11px">Auto Inject on Save</label>
        </div>
        <div class="flex-row" title="Verify file integrity with CRC after transfer">
          <input type="checkbox" id="verifyCrc" checked onchange="onVerifyCrcChange()" />
          <label for="verifyCrc" style="font-size: 11px">Verify CRC after Transfer</label>
        </div>
        <div
          class="flex-row"
          title="Enable decompilation when creating patch templates (requires angr, may increase wait time)"
        >
          <input type="checkbox" id="enableDecompile" onchange="onEnableDecompileChange()" />
          <label for="enableDecompile" style="font-size: 11px">Enable Decompilation</label>
        </div>
        <div class="watch-dirs-section" id="watchDirsSection" style="display: none">
          <div class="flex-row" style="margin-bottom: 4px">
            <span style="font-size: 10px; opacity: 0.7; flex: 1">Watch Directories</span>
            <button
              class="vscode-btn icon-only secondary"
              onclick="addWatchDir()"
              title="Add Directory"
              style="width: 20px; height: 20px; padding: 0"
            >
              <i class="codicon codicon-add" style="font-size: 12px"></i>
            </button>
          </div>
          <div id="watchDirsList" class="watch-dirs-list">
            <!-- Dynamically populated -->
          </div>
        </div>
      </div>
    </div>
    <div class="sidebar-section-resize-handle"></div>
  </details>
</div>
